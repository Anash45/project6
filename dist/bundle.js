(() => { const e = document.getElementById("textarea"), t = document.getElementById("output"), n = document.getElementById("currentLine"), o = indexedDB.open("text_editor", 1); function d() { const e = o.result.transaction("entries", "readonly").objectStore("entries").get(1); e.onsuccess = function () { const o = e.result; if (o && o.content) { const e = o.content.split("\n"); t.innerHTML = ""; let d = 1; e.forEach((e => { const n = document.createElement("div"); n.classList.add("line"), n.innerHTML = `<span class="line-no">${d}</span><span class="line-content">${e}</span>`, t.appendChild(n), d++ })), n.textContent = d } } } o.onupgradeneeded = function () { o.result.createObjectStore("entries", { keyPath: "id" }) }, e.addEventListener("keydown", (function (i) { "Enter" === i.key && (i.preventDefault(), function (i) { const c = o.result.transaction("entries", "readwrite"), r = c.objectStore("entries"), s = r.get(1); t.innerHTML = "", e.value = "", "clear" === i ? (r.put({ id: 1, content: "" }), c.oncomplete = function () { console.log("Cleared from IndexedDB"), d(), n.textContent = 1 }) : s.onsuccess = function () { const e = s.result; let t = i; e && e.content && (t = e.content + "\n" + i), r.put({ id: 1, content: t }), c.oncomplete = function () { d(), console.log("Content saved to IndexedDB") } } }(e.value)) })), document.addEventListener("DOMContentLoaded", (function () { e.focus(), d() })), document.getElementById("terminal").addEventListener("click", (function (t) { e.focus() })), window.addEventListener("beforeinstallprompt", (function (e) { e.preventDefault(), window.deferredPrompt = e, i.style.visibility = "visible" })); const i = document.getElementById("installButton"); i.addEventListener("click", (async () => { window.deferredPrompt && (window.deferredPrompt.preventDefault(), window.deferredPrompt.prompt(), "accepted" === (await window.deferredPrompt.userChoice).outcome ? (console.log("User accepted the installation"), i.style.visibility = "hidden") : console.log("User dismissed the installation"), window.deferredPrompt = null) })) })();